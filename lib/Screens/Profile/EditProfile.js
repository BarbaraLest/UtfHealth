var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=EditProfile;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _reactNativePaper=require("react-native-paper");var _styles=_interopRequireDefault(require("./styles"));var _formik=require("formik");var yup=_interopRequireWildcard(require("yup"));var _asyncStorage=_interopRequireDefault(require("@react-native-async-storage/async-storage"));var _axios=_interopRequireDefault(require("axios"));var _jsxFileName="C:\\Users\\barba\\Documents\\TDS 2020.2\\ProjetoFinal\\Projeto\\UtfHealth\\src\\Screens\\Profile\\EditProfile.js";function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!=="function")return null;var cacheBabelInterop=new WeakMap();var cacheNodeInterop=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj;}if(obj===null||typeof obj!=="object"&&typeof obj!=="function"){return{default:obj};}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj);}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}newObj.default=obj;if(cache){cache.set(obj,newObj);}return newObj;}function EditProfile(_ref){var _this=this;var navigation=_ref.navigation,route=_ref.route;var user=route.params;console.log(user);function editAccount(name,email,register,password){var id;return _regenerator.default.async(function editAccount$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regenerator.default.awrap(_asyncStorage.default.getItem('@UtfApi:id'));case 2:id=_context.sent;_axios.default.patch("http://10.0.2.2:3000/student",{"email":email,"name":name,"register":register,"password":password,"idStudent":id}).then(function(response){console.log(response.data);createSuccessAlert();}).catch(function(error){createUnsuccessAlert();console.log(error);}).then(function(){});case 4:case"end":return _context.stop();}}},null,null,null,Promise);}var createSuccessAlert=function createSuccessAlert(){return _reactNative.Alert.alert("Parabéns!","Sua conta foi alterada com sucesso.",[{text:"Ok",onPress:function onPress(){return navigation.navigate('Profile');}}]);};var createUnsuccessAlert=function createUnsuccessAlert(){return _reactNative.Alert.alert("Ops!","Não foi possível alterar a sua conta. Verifique suas informações e tente novamente.",[{text:"Ok"}]);};var _React$useState=_react.default.useState({secureTextEntry:true,passwordSecureIcon:'eye-off'}),_React$useState2=(0,_slicedToArray2.default)(_React$useState,2),data=_React$useState2[0],setData=_React$useState2[1];var updateSecureTextEntry=function updateSecureTextEntry(){setData((0,_extends2.default)({},data,{secureTextEntry:!data.secureTextEntry,passwordSecureIcon:'eye'}));};var reviewSchema=yup.object({name:yup.string().required('Campo obrigatório*').max(255,'Quantidade de caracteres excessiva'),username:yup.string().required('Campo obrigatório*').max(255,'Quantidade de caracteres excessiva'),email:yup.string().required('Campo obrigatório*').max(255,'Quantidade de caracteres excessiva'),register:yup.string().required('Campo obrigatório*').max(10,'Quantidade de caracteres excessiva'),password:yup.string().required('Campo obrigatório*').max(255,'Quantidade de caracteres excessiva')});return _react.default.createElement(_reactNativePaper.Provider,{theme:theme,__self:this,__source:{fileName:_jsxFileName,lineNumber:118,columnNumber:9}},_react.default.createElement(_reactNative.View,{style:_styles.default.background,__self:this,__source:{fileName:_jsxFileName,lineNumber:119,columnNumber:13}},_react.default.createElement(_reactNativePaper.Appbar.Header,{style:{backgroundColor:"#ff8b80"},__self:this,__source:{fileName:_jsxFileName,lineNumber:121,columnNumber:17}},_react.default.createElement(_reactNativePaper.Appbar.BackAction,{onPress:navigation.goBack,color:'#404040',__self:this,__source:{fileName:_jsxFileName,lineNumber:122,columnNumber:21}}),_react.default.createElement(_reactNativePaper.Appbar.Content,{title:"Editar minhas informa\xE7\xF5es",color:'#404040',__self:this,__source:{fileName:_jsxFileName,lineNumber:123,columnNumber:21}})),_react.default.createElement(_reactNative.ImageBackground,{style:{width:'100%',height:'100%'},__self:this,__source:{fileName:_jsxFileName,lineNumber:125,columnNumber:17}},_react.default.createElement(_formik.Formik,{initialValues:{name:user.name,email:user.email,register:user.register,password:''},validationSchema:reviewSchema,__self:this,__source:{fileName:_jsxFileName,lineNumber:126,columnNumber:21}},function(props){return _react.default.createElement(_reactNative.TouchableWithoutFeedback,{onPress:_reactNative.Keyboard.dismiss,__self:_this,__source:{fileName:_jsxFileName,lineNumber:135,columnNumber:29}},_react.default.createElement(_reactNative.View,{style:_styles.default.componentsView,__self:_this,__source:{fileName:_jsxFileName,lineNumber:136,columnNumber:33}},_react.default.createElement(_reactNative.View,{style:{flex:3,justifyContent:'flex-end'},__self:_this,__source:{fileName:_jsxFileName,lineNumber:137,columnNumber:37}},_react.default.createElement(_reactNative.Text,{style:{fontSize:30,color:'#c85b53',fontFamily:'sans-serif',alignSelf:'center',marginBottom:100},__self:_this,__source:{fileName:_jsxFileName,lineNumber:138,columnNumber:41}},"Informa\xE7\xF5es da conta"),_react.default.createElement(_reactNativePaper.TextInput,{label:"Nome",mode:"flat",placeholderTextColor:"#c85b53",style:_styles.default.textInput,underlineColor:"#c85b53",value:props.values.name,onChangeText:props.handleChange('name'),onBlur:props.handleBlur('name'),left:_react.default.createElement(_reactNativePaper.TextInput.Icon,{name:"rename-box",color:"#ffbdaf",__self:_this,__source:{fileName:_jsxFileName,lineNumber:148,columnNumber:51}}),__self:_this,__source:{fileName:_jsxFileName,lineNumber:139,columnNumber:41}}),_react.default.createElement(_reactNative.Text,{style:_styles.default.textError,__self:_this,__source:{fileName:_jsxFileName,lineNumber:150,columnNumber:41}},props.touched.name&&props.errors.name),_react.default.createElement(_reactNativePaper.TextInput,{label:"Email",mode:"flat",placeholderTextColor:"#c85b53",style:_styles.default.textInput,underlineColor:"#c85b53",value:props.values.email,onChangeText:props.handleChange('email'),onBlur:props.handleBlur('email'),left:_react.default.createElement(_reactNativePaper.TextInput.Icon,{name:"rename-box",color:"#ffbdaf",__self:_this,__source:{fileName:_jsxFileName,lineNumber:163,columnNumber:51}}),__self:_this,__source:{fileName:_jsxFileName,lineNumber:154,columnNumber:41}}),_react.default.createElement(_reactNative.Text,{style:_styles.default.textError,__self:_this,__source:{fileName:_jsxFileName,lineNumber:165,columnNumber:41}},props.touched.email&&props.errors.email),_react.default.createElement(_reactNativePaper.TextInput,{label:"Registro",mode:"flat",placeholderTextColor:"#c85b53",style:_styles.default.textInput,underlineColor:"#c85b53",value:props.values.register,onChangeText:props.handleChange('register'),onBlur:props.handleBlur('register'),left:_react.default.createElement(_reactNativePaper.TextInput.Icon,{name:"rename-box",color:"#ffbdaf",__self:_this,__source:{fileName:_jsxFileName,lineNumber:178,columnNumber:51}}),__self:_this,__source:{fileName:_jsxFileName,lineNumber:169,columnNumber:41}}),_react.default.createElement(_reactNative.Text,{style:_styles.default.textError,__self:_this,__source:{fileName:_jsxFileName,lineNumber:180,columnNumber:41}},props.touched.register&&props.errors.register),_react.default.createElement(_reactNativePaper.TextInput,{label:"Senha",mode:"flat",placeholderTextColor:"#c85b53",style:_styles.default.textInput,underlineColor:"#c85b53",value:props.values.password,onChangeText:props.handleChange('password'),onBlur:props.handleBlur('password'),secureTextEntry:data.secureTextEntry?true:false,left:_react.default.createElement(_reactNativePaper.TextInput.Icon,{name:"key",color:"#ffbdaf",__self:_this,__source:{fileName:_jsxFileName,lineNumber:194,columnNumber:51}}),right:_react.default.createElement(_reactNativePaper.TextInput.Icon,{name:data.passwordSecureIcon,color:"#ffbdaf",onPress:updateSecureTextEntry,__self:_this,__source:{fileName:_jsxFileName,lineNumber:196,columnNumber:49}}),__self:_this,__source:{fileName:_jsxFileName,lineNumber:184,columnNumber:41}}),_react.default.createElement(_reactNative.Text,{style:_styles.default.textError,__self:_this,__source:{fileName:_jsxFileName,lineNumber:204,columnNumber:41}},props.touched.password&&props.errors.password),_react.default.createElement(_reactNative.Text,{style:{marginBottom:25},__self:_this,__source:{fileName:_jsxFileName,lineNumber:207,columnNumber:41}})),_react.default.createElement(_reactNative.View,{style:_styles.default.buttonsView,__self:_this,__source:{fileName:_jsxFileName,lineNumber:209,columnNumber:37}},_react.default.createElement(_reactNativePaper.FAB,{style:_styles.default.buttonNewAcc,label:"Cancelar",onPress:navigation.goBack,__self:_this,__source:{fileName:_jsxFileName,lineNumber:210,columnNumber:41}}),_react.default.createElement(_reactNativePaper.FAB,{style:_styles.default.buttonNewAcc,label:"Salvar",onPress:function onPress(){return editAccount(props.values.name,props.values.email,props.values.register,props.values.password);},__self:_this,__source:{fileName:_jsxFileName,lineNumber:215,columnNumber:41}}))));}))));}var theme=(0,_extends2.default)({},_reactNativePaper.DefaultTheme,{roundness:2,colors:(0,_extends2.default)({},_reactNativePaper.DefaultTheme.colors,{primary:'#ff8b80',accent:'#c85b53',background:'#f5f5f6'})});