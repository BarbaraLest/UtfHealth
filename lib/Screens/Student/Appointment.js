var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=Appointment;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _reactNativePaper=require("react-native-paper");var _axios=_interopRequireDefault(require("axios"));var _reactNativeModalize=require("react-native-modalize");var _asyncStorage=_interopRequireDefault(require("@react-native-async-storage/async-storage"));var _reactNativeCalendars=require("react-native-calendars");var _styles=_interopRequireDefault(require("./components/styles"));var _MaterialIcons=_interopRequireDefault(require("react-native-vector-icons/MaterialIcons"));var _dates=_interopRequireDefault(require("./../../Models/Doctor/dates"));var _jsxFileName="C:\\Users\\barba\\Documents\\TDS 2020.2\\ProjetoFinal\\Projeto\\UtfHealth\\src\\Screens\\Student\\Appointment.js";function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!=="function")return null;var cacheBabelInterop=new WeakMap();var cacheNodeInterop=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj;}if(obj===null||typeof obj!=="object"&&typeof obj!=="function"){return{default:obj};}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj);}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}newObj.default=obj;if(cache){cache.set(obj,newObj);}return newObj;}_reactNative.LogBox.ignoreAllLogs();function Appointment(_ref){var navigation=_ref.navigation,previus=_ref.previus;(0,_react.useEffect)(function(){responseDoctor();console.log(_dates.default);},[]);_reactNativeCalendars.LocaleConfig.locales['br']={monthNames:['Janeiro','Fevereiro','Março','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'],monthNamesShort:['Jan.','Fev','Mar','Abr','Mai','Jun','Jul','Ago','Set','Out','Nov','Dez'],dayNames:['Domingo','Segunda','Terça','Quarta','Quinta','Sexta','Sabádo'],dayNamesShort:['Dom','Seg','Ter','Qua','Qui','Sex','Sab'],today:'Hoje'};_reactNativeCalendars.LocaleConfig.defaultLocale='br';var dados1=[{id:1,name:'Nuape'},{id:2,name:'Conferencia online'},{id:3,name:'Setor clinico UTFPR'}];var times=[{id:1,time:'9:00',available:"Disponível"},{id:2,time:'10:00',available:"Disponível"},{id:3,time:'11:00',available:"Indisponível"},{id:4,time:'14:00',available:"Indisponível"},{id:5,time:'15:00',available:"Disponível"},{id:6,time:'16:00',available:"Disponível"}];var _useState=(0,_react.useState)(),_useState2=(0,_slicedToArray2.default)(_useState,2),observations=_useState2[0],setObservations=_useState2[1];var _useState3=(0,_react.useState)({id:null}),_useState4=(0,_slicedToArray2.default)(_useState3,2),doctorId=_useState4[0],setDoctorId=_useState4[1];var doctorIdCallback=(0,_react.useCallback)(function(itemId){setDoctorId({id:itemId});console.log(doctorId);},[doctorId]);var _useState5=(0,_react.useState)({id:null}),_useState6=(0,_slicedToArray2.default)(_useState5,2),localId=_useState6[0],setLocalId=_useState6[1];var localIdCallback=(0,_react.useCallback)(function(itemId,name){setLocalId({id:itemId,place:name});console.log(localId);},[localId]);var _useState7=(0,_react.useState)({date:null}),_useState8=(0,_slicedToArray2.default)(_useState7,2),date=_useState8[0],setDate=_useState8[1];var _useState9=(0,_react.useState)({time:null}),_useState10=(0,_slicedToArray2.default)(_useState9,2),time=_useState10[0],setTime=_useState10[1];var dateCallback=(0,_react.useCallback)(function(date){setDate({date:date});console.log(date);},[date]);var timeCallback=(0,_react.useCallback)(function(time){setTime({time:time});console.log(time);},[time]);var modalizeSpecialtyRef=(0,_react.useRef)(null);var onOpen1=function onOpen1(){var _modalizeSpecialtyRef;(_modalizeSpecialtyRef=modalizeSpecialtyRef.current)==null?void 0:_modalizeSpecialtyRef.open();};var onClose1=function onClose1(){var _modalizeSpecialtyRef2;(_modalizeSpecialtyRef2=modalizeSpecialtyRef.current)==null?void 0:_modalizeSpecialtyRef2.close();};var modalizeCalendarRef=(0,_react.useRef)(null);var onOpen2=function onOpen2(){var _modalizeCalendarRef$;(_modalizeCalendarRef$=modalizeCalendarRef.current)==null?void 0:_modalizeCalendarRef$.open();};var onClose2=function onClose2(){var _modalizeCalendarRef$2;(_modalizeCalendarRef$2=modalizeCalendarRef.current)==null?void 0:_modalizeCalendarRef$2.close();};var modalizeLocalRef=(0,_react.useRef)(null);var onOpen3=function onOpen3(){var _modalizeLocalRef$cur;(_modalizeLocalRef$cur=modalizeLocalRef.current)==null?void 0:_modalizeLocalRef$cur.open();};var onClose3=function onClose3(){var _modalizeLocalRef$cur2;(_modalizeLocalRef$cur2=modalizeLocalRef.current)==null?void 0:_modalizeLocalRef$cur2.close();};function availableOrNot(available){if(available=="Disponível"){return'#90ee02';}else{return"#e54304";}}function Person(_ref2){var name=_ref2.name,specialty=_ref2.specialty,itemId=_ref2.itemId;return _react.default.createElement(_reactNative.TouchableOpacity,{onPress:function onPress(){doctorIdCallback(itemId);onClose1();},__self:this,__source:{fileName:_jsxFileName,lineNumber:140,columnNumber:13}},_react.default.createElement(_reactNative.View,{style:{flexDirection:'column'},__self:this,__source:{fileName:_jsxFileName,lineNumber:144,columnNumber:17}},_react.default.createElement(_reactNative.Text,{style:_styles.default.textFlatlistRow,__self:this,__source:{fileName:_jsxFileName,lineNumber:145,columnNumber:21}},specialty),_react.default.createElement(_reactNative.Text,{style:_styles.default.subTextFlatlistRow,__self:this,__source:{fileName:_jsxFileName,lineNumber:146,columnNumber:21}},name)),_react.default.createElement(_reactNativePaper.Divider,{style:{backgroundColor:'#c2c6ca',marginTop:20},__self:this,__source:{fileName:_jsxFileName,lineNumber:149,columnNumber:17}}));}function ModalizeDoctor(){var _this=this;return _react.default.createElement(_reactNative.View,{__self:this,__source:{fileName:_jsxFileName,lineNumber:156,columnNumber:13}},_react.default.createElement(_reactNative.View,{__self:this,__source:{fileName:_jsxFileName,lineNumber:157,columnNumber:17}},_react.default.createElement(_reactNative.Text,{style:{marginTop:40,marginLeft:20,fontSize:23,fontFamily:'sans-serif',color:'#3d3935',fontWeight:'bold'},__self:this,__source:{fileName:_jsxFileName,lineNumber:158,columnNumber:21}},"Selecione o especialista"),_react.default.createElement(_reactNative.View,{__self:this,__source:{fileName:_jsxFileName,lineNumber:166,columnNumber:21}},_react.default.createElement(_reactNative.FlatList,{style:{marginTop:40},data:doctorList.doctorList,keyExtractor:function keyExtractor(item){return item.id;},renderItem:function renderItem(_ref3){var item=_ref3.item;return _react.default.createElement(Person,{name:item.name,specialty:item.specialty,itemId:item.idDoctor,__self:_this,__source:{fileName:_jsxFileName,lineNumber:172,columnNumber:33}});},__self:this,__source:{fileName:_jsxFileName,lineNumber:167,columnNumber:25}}))));}function Schedules(_ref4){var time=_ref4.time,itemId=_ref4.itemId,available=_ref4.available;return _react.default.createElement(_reactNative.TouchableOpacity,{onPress:function onPress(){{available=="Disponível"?(timeCallback(time),onClose2()):_reactNative.Alert.alert("Atenção!","Esse horário não está disponível.",[{text:"Ok",onPress:function onPress(){return console.log("Cancel Pressed");},style:"Ok"}]);}},__self:this,__source:{fileName:_jsxFileName,lineNumber:184,columnNumber:13}},_react.default.createElement(_reactNative.View,{style:{flexDirection:'row',justifyContent:'space-between',alignItems:'center'},__self:this,__source:{fileName:_jsxFileName,lineNumber:206,columnNumber:17}},_react.default.createElement(_reactNative.View,{style:{flexDirection:'column',flex:2},__self:this,__source:{fileName:_jsxFileName,lineNumber:207,columnNumber:21}},_react.default.createElement(_reactNative.Text,{style:_styles.default.textFlatlistRow,__self:this,__source:{fileName:_jsxFileName,lineNumber:208,columnNumber:25}},time),_react.default.createElement(_reactNative.Text,{style:_styles.default.subTextFlatlistRow,__self:this,__source:{fileName:_jsxFileName,lineNumber:209,columnNumber:25}},"Dura\xE7\xE3o: 1 hora")),_react.default.createElement(_reactNative.View,{style:{flex:1,alignItems:'center',marginRight:10,height:'60%',backgroundColor:availableOrNot(available)},__self:this,__source:{fileName:_jsxFileName,lineNumber:211,columnNumber:21}},_react.default.createElement(_reactNative.Text,{style:_styles.default.textFlatlistRowAvailable,__self:this,__source:{fileName:_jsxFileName,lineNumber:212,columnNumber:25}},available))),_react.default.createElement(_reactNativePaper.Divider,{style:{backgroundColor:'#c2c6ca',marginTop:20},__self:this,__source:{fileName:_jsxFileName,lineNumber:215,columnNumber:17}}));}function ModalizeCalendar(){var _this2=this;return _react.default.createElement(_reactNative.View,{style:{flex:1},__self:this,__source:{fileName:_jsxFileName,lineNumber:222,columnNumber:13}},_react.default.createElement(_reactNative.View,{style:{backgroundColor:"#d602ee"},__self:this,__source:{fileName:_jsxFileName,lineNumber:223,columnNumber:17}},_react.default.createElement(_reactNativeCalendars.Calendar,{minDate:'2012-05-10',onDayPress:function onDayPress(day){dateCallback(day.dateString);},monthFormat:'MMMM ',firstDay:1,hideDayNames:false,showWeekNumbers:true,enableSwipeMonths:true,onPressArrowLeft:function onPressArrowLeft(subtractMonth){return subtractMonth();},markingType:'period',markedDates:_dates.default,__self:this,__source:{fileName:_jsxFileName,lineNumber:224,columnNumber:21}})),_react.default.createElement(_reactNative.View,{__self:this,__source:{fileName:_jsxFileName,lineNumber:238,columnNumber:17}},_react.default.createElement(_reactNative.Text,{style:{marginTop:40,marginLeft:20,fontSize:23,fontFamily:'sans-serif',color:'#3d3935',fontWeight:'bold'},__self:this,__source:{fileName:_jsxFileName,lineNumber:239,columnNumber:21}},"Selecione o hor\xE1rio:"),_react.default.createElement(_reactNative.View,{__self:this,__source:{fileName:_jsxFileName,lineNumber:247,columnNumber:21}},_react.default.createElement(_reactNative.FlatList,{style:{marginTop:40},data:times,keyExtractor:function keyExtractor(item){return item.id;},renderItem:function renderItem(_ref5){var item=_ref5.item;return _react.default.createElement(Schedules,{time:item.time,itemId:item.id,available:item.available,__self:_this2,__source:{fileName:_jsxFileName,lineNumber:253,columnNumber:33}});},__self:this,__source:{fileName:_jsxFileName,lineNumber:248,columnNumber:25}}))));}function Local(_ref6){var local=_ref6.local,id=_ref6.id;return _react.default.createElement(_reactNative.TouchableOpacity,{onPress:function onPress(){localIdCallback(id,local);onClose3();},__self:this,__source:{fileName:_jsxFileName,lineNumber:264,columnNumber:13}},_react.default.createElement(_reactNative.View,{style:{flexDirection:'row'},__self:this,__source:{fileName:_jsxFileName,lineNumber:268,columnNumber:17}},_react.default.createElement(_reactNative.Text,{style:_styles.default.textFlatlistRow,__self:this,__source:{fileName:_jsxFileName,lineNumber:269,columnNumber:21}},local," ")),_react.default.createElement(_reactNativePaper.Divider,{style:{backgroundColor:'#c2c6ca',marginTop:20},__self:this,__source:{fileName:_jsxFileName,lineNumber:271,columnNumber:17}}));}function ModalizeLocal(){var _this3=this;return _react.default.createElement(_reactNative.View,{__self:this,__source:{fileName:_jsxFileName,lineNumber:278,columnNumber:13}},_react.default.createElement(_reactNative.View,{__self:this,__source:{fileName:_jsxFileName,lineNumber:279,columnNumber:17}},_react.default.createElement(_reactNative.Text,{style:{marginTop:40,marginLeft:20,fontSize:23,fontFamily:'sans-serif',color:'#3d3935',fontWeight:'bold'},__self:this,__source:{fileName:_jsxFileName,lineNumber:280,columnNumber:21}},"Selecione o local de atendimento"),_react.default.createElement(_reactNative.View,{__self:this,__source:{fileName:_jsxFileName,lineNumber:288,columnNumber:21}},_react.default.createElement(_reactNative.FlatList,{style:{marginTop:40},data:dados1,keyExtractor:function keyExtractor(item){return item.id;},renderItem:function renderItem(_ref7){var item=_ref7.item;return _react.default.createElement(Local,{local:item.name,id:item.id,__self:_this3,__source:{fileName:_jsxFileName,lineNumber:294,columnNumber:33}});},__self:this,__source:{fileName:_jsxFileName,lineNumber:289,columnNumber:25}}))));}var _useState11=(0,_react.useState)(null),_useState12=(0,_slicedToArray2.default)(_useState11,2),doctorList=_useState12[0],setDoctorList=_useState12[1];function responseDoctor(){return _regenerator.default.async(function responseDoctor$(_context){while(1){switch(_context.prev=_context.next){case 0:_axios.default.get("http://10.0.2.2:3000/doctor").then(function(response){console.log(response.data.data);setDoctorList({doctorList:response.data.data});}).catch(function(error){console.log(error);}).then(function(){});case 1:case"end":return _context.stop();}}},null,null,null,Promise);}function createAppointment(){var id;return _regenerator.default.async(function createAppointment$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _regenerator.default.awrap(_asyncStorage.default.getItem('@UtfApi:idStudent'));case 2:id=_context2.sent;_axios.default.post("http://10.0.2.2:3000/appointment",{"Student_idStudent":id,"Doctor_idDoctor":doctorId.id,"date":date.date,"time":time.time,"place":localId.place,"observations":observations}).then(function(response){console.log(response.data);createSuccessAlert();}).catch(function(error){createUnsuccessAlert();console.log(error);}).then(function(){});case 4:case"end":return _context2.stop();}}},null,null,null,Promise);}var createSuccessAlert=function createSuccessAlert(){return _reactNative.Alert.alert("Parabéns!","Sua consulta foi marcada com sucesso.",[{text:"Ok",onPress:function onPress(){return navigation.navigate('Home');}}]);};var createUnsuccessAlert=function createUnsuccessAlert(){return _reactNative.Alert.alert("Ops!","Não foi possível marcar a sua consulta. Verifique suas informações e tente novamente.",[{text:"Ok",onPress:function onPress(){return navigation.navigate('Home');}}]);};return _react.default.createElement(_reactNativePaper.Provider,{theme:_styles.default.theme,__self:this,__source:{fileName:_jsxFileName,lineNumber:362,columnNumber:9}},_react.default.createElement(_reactNative.TouchableWithoutFeedback,{onPress:_reactNative.Keyboard.dismiss,__self:this,__source:{fileName:_jsxFileName,lineNumber:363,columnNumber:13}},_react.default.createElement(_reactNative.View,{style:_styles.default.background,__self:this,__source:{fileName:_jsxFileName,lineNumber:364,columnNumber:17}},_react.default.createElement(_reactNativePaper.Appbar.Header,{style:{backgroundColor:"#FF8A80"},__self:this,__source:{fileName:_jsxFileName,lineNumber:365,columnNumber:21}},_react.default.createElement(_reactNativePaper.Appbar.BackAction,{onPress:navigation.goBack,color:'#404040',__self:this,__source:{fileName:_jsxFileName,lineNumber:366,columnNumber:25}}),_react.default.createElement(_reactNativePaper.Appbar.Content,{title:"Nova consulta",color:'#404040',__self:this,__source:{fileName:_jsxFileName,lineNumber:367,columnNumber:25}})),_react.default.createElement(_reactNative.View,{style:{flex:1},__self:this,__source:{fileName:_jsxFileName,lineNumber:369,columnNumber:21}},_react.default.createElement(_reactNative.View,{style:_styles.default.componentsView,__self:this,__source:{fileName:_jsxFileName,lineNumber:370,columnNumber:25}},_react.default.createElement(_reactNative.View,{style:{flex:3,justifyContent:'space-evenly'},__self:this,__source:{fileName:_jsxFileName,lineNumber:371,columnNumber:29}},_react.default.createElement(_reactNative.TouchableOpacity,{style:_styles.default.touchableOpacity,onPress:onOpen1,__self:this,__source:{fileName:_jsxFileName,lineNumber:372,columnNumber:33}},_react.default.createElement(_reactNative.Text,{style:_styles.default.textTouchableOpacity,__self:this,__source:{fileName:_jsxFileName,lineNumber:373,columnNumber:37}},"Especialista"),_react.default.createElement(_MaterialIcons.default,{name:"keyboard-arrow-down",size:30,color:"#900",style:{marginRight:20},__self:this,__source:{fileName:_jsxFileName,lineNumber:374,columnNumber:37}})),_react.default.createElement(_reactNative.TouchableOpacity,{style:_styles.default.touchableOpacity,onPress:onOpen2,__self:this,__source:{fileName:_jsxFileName,lineNumber:377,columnNumber:33}},_react.default.createElement(_reactNative.Text,{style:_styles.default.textTouchableOpacity,__self:this,__source:{fileName:_jsxFileName,lineNumber:378,columnNumber:37}},"Data"),_react.default.createElement(_MaterialIcons.default,{name:"keyboard-arrow-down",size:30,color:"#900",style:{marginRight:20},__self:this,__source:{fileName:_jsxFileName,lineNumber:379,columnNumber:37}})),_react.default.createElement(_reactNative.TouchableOpacity,{style:_styles.default.touchableOpacity,onPress:onOpen3,__self:this,__source:{fileName:_jsxFileName,lineNumber:382,columnNumber:33}},_react.default.createElement(_reactNative.Text,{style:_styles.default.textTouchableOpacity,__self:this,__source:{fileName:_jsxFileName,lineNumber:383,columnNumber:37}},"Local"),_react.default.createElement(_MaterialIcons.default,{name:"keyboard-arrow-down",size:30,color:"#900",style:{marginRight:20},__self:this,__source:{fileName:_jsxFileName,lineNumber:384,columnNumber:37}})),_react.default.createElement(_reactNativePaper.TextInput,{label:"Observa\xE7\xF5es",mode:"flat",placeholderTextColor:"#c85b53",value:observations,onChangeText:function onChangeText(observations){return setObservations(observations);},style:_styles.default.textInput,underlineColor:"#c85b53",left:_react.default.createElement(_reactNativePaper.TextInput.Icon,{name:"rename-box",color:"#ffbdaf",__self:this,__source:{fileName:_jsxFileName,lineNumber:396,columnNumber:43}}),__self:this,__source:{fileName:_jsxFileName,lineNumber:388,columnNumber:33}})),_react.default.createElement(_reactNative.View,{style:_styles.default.buttonsView,__self:this,__source:{fileName:_jsxFileName,lineNumber:399,columnNumber:29}},_react.default.createElement(_reactNativePaper.FAB,{style:_styles.default.buttonNewAcc,label:"Cancelar",onPress:function onPress(){return console.log(doctorId.id);},__self:this,__source:{fileName:_jsxFileName,lineNumber:400,columnNumber:33}}),_react.default.createElement(_reactNativePaper.FAB,{style:_styles.default.buttonNewAcc,label:"Salvar",onPress:function onPress(){return createAppointment();},__self:this,__source:{fileName:_jsxFileName,lineNumber:407,columnNumber:33}}))),_react.default.createElement(_reactNativeModalize.Modalize,{ref:modalizeSpecialtyRef,snapPoint:'550',modalHeight:600,__self:this,__source:{fileName:_jsxFileName,lineNumber:414,columnNumber:25}},_react.default.createElement(ModalizeDoctor,{__self:this,__source:{fileName:_jsxFileName,lineNumber:419,columnNumber:29}})),_react.default.createElement(_reactNativeModalize.Modalize,{ref:modalizeCalendarRef,snapPoint:'650',modalHeight:700,__self:this,__source:{fileName:_jsxFileName,lineNumber:422,columnNumber:25}},_react.default.createElement(ModalizeCalendar,{__self:this,__source:{fileName:_jsxFileName,lineNumber:427,columnNumber:29}})),_react.default.createElement(_reactNativeModalize.Modalize,{ref:modalizeLocalRef,snapPoint:'600',modalHeight:600,__self:this,__source:{fileName:_jsxFileName,lineNumber:430,columnNumber:25}},_react.default.createElement(ModalizeLocal,{__self:this,__source:{fileName:_jsxFileName,lineNumber:435,columnNumber:29}}))))));}